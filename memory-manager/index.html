<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Manage data in an environment with limited memory">  
    <link rel="canonical" href="https://docs.zendframework.com/memory-manager/">
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Memory Manager - zend-memory - Zend Framework Docs</title>

    <link rel="stylesheet" href="/css/styles.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-memory</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Memory Manager</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../memory-objects/" class="subnavigation__link">Memory Objects</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-memory</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-memory/" class="header__link header__link--github" title="Go to repository of zend-memory">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="laminas-announcement">
    <div class="container">
        <div class="row">
            <div class="col-xs-12"><strong>
                This package has moved. Visit its replacement, <a href="https://docs.laminas.dev/laminas-memory/">laminas/laminas-memory.</a>
            </strong></div>
        </div>
    </div>
</div>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="..">zend-memory</a></li>

            
                
                    
                    
                        <li>Reference</li>
                    
                
            

            <li class="active">Memory Manager</li>
        
    
</ol>






    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <div>
        
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#creating-a-memory-manager" class="toc__link">Creating a Memory Manager</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#managing-memory-objects" class="toc__link">Managing Memory Objects</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#settings" class="toc__link">Settings</a>
                    </li>
                
            </ul>
        </div>
    

    </div>

    <h1 id="memory-manager">Memory Manager</h1>
<h2 id="creating-a-memory-manager">Creating a Memory Manager</h2>
<p>You can create new a memory manager (<code>Zend\Memory\MemoryManager</code> object) using its constructor:</p>
<pre><code class="language-php">__construct(Zend\Cache\Storage\StorageInterface $cache = null) : void
</code></pre>

<p>As an example, the following creates an instance which <em>is not</em> backed by cache
storage:</p>
<pre><code class="language-php">$memoryManager = new Zend\Memory\MemoryManager();
</code></pre>

<p>While the following creates an instance backed by a filesystem cache storage
adapter, storing memory blocks in the <code>tmp/</code> directory of the current working
directory:</p>
<pre><code class="language-php">use Zend\Cache\StorageFactory;
use Zend\Memory\MemoryManager;

$cache = StorageFactory::factory([
    'adapter' =&gt; [
        'name' =&gt; 'Filesystem',
        'options' =&gt; [
            'cache_dir' =&gt; './tmp/', // Directory in which to put swapped memory blocks
        ],
    ],
]);

$memoryManager = new MemoryManager($cache);
</code></pre>

<p>The <code>MemoryManager</code> uses <a href="http://docs.zendframework.com/zend-cache/storage/adapter/">zend-cache storage adapters</a>
to cache memory blocks; if no cache instance is provided, the system temporary
directory is used. This is useful if you know that memory is not limited or the
overall size of objects never reaches the memory limit.</p>
<h2 id="managing-memory-objects">Managing Memory Objects</h2>
<p>This section describes creating and destroying objects in the managed memory,
and settings to control memory manager behavior.</p>
<h3>Creating Movable Objects</h3>
<p>Create movable objects (objects which may be swapped into cache storage) using
the <code>Zend\Memory\MemoryManager::create([$data])</code> method:</p>
<pre><code class="language-php">$memObject = $memoryManager-&gt;create($data);
</code></pre>

<p>The <code>$data</code> argument is optional and used to initialize the object value. If the
<code>$data</code> argument is omitted, the value is an empty string.</p>
<h3>Creating Locked Objects</h3>
<p>Create locked objects (objects which will never be swapped into cache storage)
using the <code>Zend\Memory\MemoryManager::createLocked([$data])</code> method:</p>
<pre><code class="language-php">$memObject = $memoryManager-&gt;createLocked($data);
</code></pre>

<p>The <code>$data</code> argument is optional and used to initialize the object value. If the
<code>$data</code> argument is omitted, the value is an empty string.</p>
<h3>Destroying Objects</h3>
<p>Memory objects are automatically destroyed and removed from memory when they go
out of scope:</p>
<pre><code class="language-php">function foo() use ($memoryManager, $memList) {
    // ...

    $memObject1 = $memoryManager-&gt;create($data1);
    $memObject2 = $memoryManager-&gt;create($data2);
    $memObject3 = $memoryManager-&gt;create($data3);

    // ...

    $memList[] = $memObject3;

    // ...

    unset($memObject2); // $memObject2 is destroyed here

    // ...
    // $memObject1 is destroyed here
    // but $memObject3 object is still referenced by $memList
    // and is not destroyed
}
</code></pre>

<p>This applies to both movable and locked objects.</p>
<h2 id="settings">Settings</h2>
<h3>Memory Limit</h3>
<p>The memory limit is the maximum number of bytes allowed for use by loaded
movable objects.</p>
<p>If loading or creation of an object causes memory usage to exceed of this limit,
then the memory manager swaps some other objects.</p>
<p>You can retrieve or set the memory limit setting using the <code>getMemoryLimit()</code> and
<code>setMemoryLimit($newLimit)</code> methods:</p>
<pre><code class="language-php">$oldLimit = $memoryManager-&gt;getMemoryLimit();  // Get memory limit in bytes
$memoryManager-&gt;setMemoryLimit($newLimit);     // Set memory limit in bytes
</code></pre>

<p>A negative value for memory limit means 'no limit'.</p>
<p>The default value is two-thirds of the value of <code>memory_limit</code> in <code>php.ini</code> or
'no limit' (-1) if <code>memory_limit</code> is not set in <code>php.ini</code>.</p>
<h3>MinSize</h3>
<p>The <code>MinSize</code> is the minimum size an object must be before it will be swapped to a
cache backend; objects with sizes smaller than this value will not be swapped.
This reduces the number of swap/load operations.</p>
<p>You can retrieve or set the minimum size using the <code>getMinSize()</code> and
<code>setMinSize($newSize)</code> methods:</p>
<pre><code class="language-php">$oldMinSize = $memoryManager-&gt;getMinSize();  // Get MinSize in bytes
$memoryManager-&gt;setMinSize($newSize);        // Set MinSize limit in bytes
</code></pre>

<p>The default minimum size value is 16KB (16384 bytes).</p>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../intro/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../memory-objects/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>




    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-memory/edit/master/docs/book/memory-manager.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-memory</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Memory Manager</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../memory-objects/" class="subnavigation__link">Memory Objects</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2020 by <a href="https://www.zend.com/">Zend</a> by <a href="https://www.perforce.com/">Perforce</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://laminas.dev/chat/" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

<nav class="cookie-bar navbar navbar-fixed-bottom navbar-default hidden">
    <div class="container">
        <p class="navbar-text">
            We use cookies to allow you to dismiss dialogs such as the Laminas
            Project notification.
        </p>
        <button type="button" class="cookie-button btn btn-default navbar-btn">Allow Cookies</button>
    </div>
</nav>

    <script>
        var base_url = '..',
            siteName = 'zend-memory';
    </script>
    <script src="/js/scripts.js"></script>
    <script src="../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
